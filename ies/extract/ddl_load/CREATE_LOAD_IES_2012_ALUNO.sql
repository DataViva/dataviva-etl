use dataviva_raw;

drop table if exists IES_2012_ALUNO_BLOCO;
create table IES_2012_ALUNO_BLOCO( dados varchar(2000) not null);

load data local infile 'H:/HEDU/Dados/2012/DADOS/ALUNO.txt'
into table IES_2012_ALUNO_BLOCO
character set 'latin1'
fields terminated by '\t'
lines terminated by '\n';

drop table if exists IES_2012_ALUNO;
create table IES_2012_ALUNO select 
substring(dados,1,8) as CO_IES,
substring(dados,9,200) as NO_IES,
substring(dados,209,8) as CO_CATEGORIA_ADMINISTRATIVA,
substring(dados,217,100) as DS_CATEGORIA_ADMINISTRATIVA,
substring(dados,317,8) as CO_ORGANIZACAO_ACADEMICA,
substring(dados,325,100) as DS_ORGANIZACAO_ACADEMICA,
substring(dados,425,8) as CO_CURSO,
substring(dados,433,200) as NO_CURSO,
substring(dados,633,8) as CO_CURSO_POLO,
substring(dados,641,8) as CO_TURNO_ALUNO,
substring(dados,649,25) as DS_TURNO_ALUNO,
substring(dados,674,8) as CO_GRAU_ACADEMICO,
substring(dados,682,12) as DS_GRAU_ACADEMICO,
substring(dados,694,8) as CO_MODALIDADE_ENSINO,
substring(dados,702,11) as DS_MODALIDADE_ENSINO,
substring(dados,713,8) as CO_NIVEL_ACADEMICO,
substring(dados,721,33) as DS_NIVEL_ACADEMICO,
substring(dados,754,8) as CO_ALUNO_CURSO,
substring(dados,762,13) as CO_ALUNO,
substring(dados,775,8) as CO_COR_RACA_ALUNO,
substring(dados,783,24) as DS_COR_RACA_ALUNO,
substring(dados,807,8) as IN_SEXO_ALUNO,
substring(dados,815,9) as DS_SEXO_ALUNO,
substring(dados,824,4) as NU_ANO_ALUNO_NASC,
substring(dados,828,2) as NU_MES_ALUNO_NASC,
substring(dados,830,2) as NU_DIA_ALUNO_NASC,
substring(dados,832,8) as NU_IDADE_ALUNO,
substring(dados,840,8) as CO_NACIONALIDADE_ALUNO,
substring(dados,848,48) as DS_NACIONALIDADE_ALUNO,
substring(dados,896,8) as CO_PAIS_ORIGEM_ALUNO,
substring(dados,904,80) as DS_PAIS_ORIGEM_ALUNO,
substring(dados,984,8) as CO_UF_NASCIMENTO,
substring(dados,992,30) as DS_UF_NASCIMENTO,
substring(dados,1022,8) as CO_MUNICIPIO_NASCIMENTO,
substring(dados,1030,150) as DS_MUNICIPIO_NASCIMENTO,
substring(dados,1180,8) as CO_ALUNO_SITUACAO,
substring(dados,1188,41) as DS_ALUNO_SITUACAO,
substring(dados,1229,8) as IN_ALUNO_DEF_TGD_SUPER,
substring(dados,1237,8) as IN_DEF_AUDITIVA,
substring(dados,1245,8) as IN_DEF_FISICA,
substring(dados,1253,8) as IN_DEF_INTELECTUAL,
substring(dados,1261,8) as IN_DEF_MULTIPLA,
substring(dados,1269,8) as IN_DEF_SURDEZ,
substring(dados,1277,8) as IN_DEF_SURDOCEGUEIRA,
substring(dados,1285,8) as IN_DEF_BAIXA_VISAO,
substring(dados,1293,8) as IN_DEF_CEGUEIRA,
substring(dados,1301,8) as IN_DEF_SUPERDOTACAO,
substring(dados,1309,8) as IN_TGD_AUTISMO_INFANTIL,
substring(dados,1317,8) as IN_TGD_SINDROME_ASPERGER,
substring(dados,1325,8) as IN_TGD_SINDROME_RETT,
substring(dados,1333,8) as IN_TGD_TRANSTOR_DESINTEGRATIVO,
substring(dados,1341,38) as DT_INGRESSO_CURSO,
substring(dados,1379,8) as IN_RESERVA_VAGAS,
substring(dados,1387,8) as IN_FINANC_ESTUDANTIL,
substring(dados,1395,8) as IN_ING_VESTIBULAR,
substring(dados,1403,8) as IN_ING_ENEM,
substring(dados,1411,8) as IN_ING_OUTRO_TIPO_SELECAO,
substring(dados,1419,8) as IN_ING_CONVENIO_PEC_G,
substring(dados,1427,8) as IN_ING_OUTRA_FORMA,
substring(dados,1435,8) as IN_RESERVA_ETNICO,
substring(dados,1443,8) as IN_RESERVA_DEFICIENCIA,
substring(dados,1451,8) as IN_RESERVA_ENSINO_PUBLICO,
substring(dados,1459,8) as IN_RES_RENDA_FAMILIAR,
substring(dados,1467,8) as IN_RESERVA_OUTROS,
substring(dados,1475,8) as IN_FIN_REEMB_FIES,
substring(dados,1483,8) as IN_FIN_REEMB_ESTADUAL,
substring(dados,1491,8) as IN_FIN_REEMB_MUNICIPAL,
substring(dados,1499,8) as IN_FIN_REEMB_PROG_IES,
substring(dados,1507,8) as IN_FIN_REEMB_ENT_EXTERNA,
substring(dados,1515,8) as IN_FIN_REEMB_OUTRA,
substring(dados,1523,8) as IN_FIN_NAOREEMB_PROUNI_INTEGR,
substring(dados,1531,8) as IN_FIN_NAOREEMB_PROUNI_PARCIAL,
substring(dados,1539,8) as IN_FIN_NAOREEMB_ESTADUAL,
substring(dados,1547,8) as IN_FIN_NAOREEMB_MUNICIPAL,
substring(dados,1555,8) as IN_FIN_NAOREEMB_PROG_IES,
substring(dados,1563,8) as IN_FIN_NAOREEMB_ENT_EXTERNA,
substring(dados,1571,8) as IN_FIN_NAOREEMB_OUTRA,
substring(dados,1579,8) as IN_APOIO_SOCIAL,
substring(dados,1587,8) as IN_APOIO_ALIMENTACAO,
substring(dados,1595,8) as IN_APOIO_BOLSA_PERMANENCIA,
substring(dados,1603,8) as IN_APOIO_BOLSA_TRABALHO,
substring(dados,1611,8) as IN_APOIO_MATERIAL_DIDATICO,
substring(dados,1619,8) as IN_APOIO_MORADIA,
substring(dados,1627,8) as IN_APOIO_TRANSPORTE,
substring(dados,1635,8) as IN_ATIVIDADE_EXTRACURRICULAR,
substring(dados,1643,8) as IN_COMPL_ESTAGIO,
substring(dados,1651,8) as IN_COMPL_EXTENSAO,
substring(dados,1659,8) as IN_COMPL_MONITORIA,
substring(dados,1667,8) as IN_COMPL_PESQUISA,
substring(dados,1675,8) as IN_BOLSA_ESTAGIO,
substring(dados,1683,8) as IN_BOLSA_EXTENSAO,
substring(dados,1691,8) as IN_BOLSA_MONITORIA,
substring(dados,1699,8) as IN_BOLSA_PESQUISA,
substring(dados,1707,8) as TP_PROCEDE_EDUC_PUBLICA,
substring(dados,1715,8) as NU_SEMESTRE_CONCLUSAO,
substring(dados,1723,8) as IN_ALUNO_PARFOR,
substring(dados,1731,8) as IN_MATRICULA,
substring(dados,1739,8) as IN_CONCLUINTE,
substring(dados,1747,8) as IN_INGRESSO_TOTAL,
substring(dados,1755,8) as IN_INGRESSO_PROCESSO_SELETIVO,
substring(dados,1763,8) as IN_INGRESSO_OUTRAS_FORMAS,
substring(dados,1771,4) as ANO_INGRESSO
from IES_2012_ALUNO_BLOCO;

select * from IES_2012_ALUNO;


