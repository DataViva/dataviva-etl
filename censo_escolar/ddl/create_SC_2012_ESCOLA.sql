use dataviva_raw;

create table SC_2012_ESCOLA_BLOCO( dados varchar(2000) not null);

load data local infile 'Y:/Censo Escolar/2012/DADOS/TS_ESCOLA.txt'
into table SC_2012_ESCOLA_BLOCO
character set 'latin1'
fields terminated by '\t'
lines terminated by '\n';

drop table if exists SC_2012_ESCOLA;
create table SC_2012_ESCOLA select 
substring(dados,1,5) as ANO_CENSO,
substring(dados,6,9) as PK_COD_ENTIDADE,
substring(dados,15,100) as NO_ENTIDADE,
substring(dados,115,5) as COD_ORGAO_REGIONAL_INEP,
substring(dados,120,15) as DESC_SITUACAO_FUNCIONAMENTO,
substring(dados,135,1) as DESC_SITUACAO_CENSO2012,
substring(dados,136,20) as DT_ANO_LETIVO_INICIO,
substring(dados,156,20) as DT_ANO_LETIVO_TERMINO,
substring(dados,176,3) as FK_COD_ESTADO,
substring(dados,179,2) as SIGLA,
substring(dados,181,9) as FK_COD_MUNICIPIO,
substring(dados,190,9) as FK_COD_DISTRITO,
substring(dados,199,1) as ID_DEPENDENCIA_ADM,
substring(dados,200,1) as ID_LOCALIZACAO,
substring(dados,201,1) as DESC_CATEGORIA_ESCOLA_PRIVADA,
substring(dados,202,1) as ID_CONVENIADA_PP,
substring(dados,203,2) as ID_TIPO_CONVENIO_PODER_PUBLICO,
substring(dados,205,1) as ID_MANT_ESCOLA_PRIVADA_EMP,
substring(dados,206,1) as ID_MANT_ESCOLA_PRIVADA_ONG,
substring(dados,207,1) as ID_MANT_ESCOLA_PRIVADA_SIND,
substring(dados,208,1) as ID_MANT_ESCOLA_PRIVADA_SIST_S,
substring(dados,209,1) as ID_MANT_ESCOLA_PRIVADA_S_FINS,
substring(dados,210,1) as ID_DOCUMENTO_REGULAMENTACAO,
substring(dados,211,1) as ID_LOCAL_FUNC_PREDIO_ESCOLAR,
substring(dados,212,1) as ID_LOCAL_FUNC_SALAS_EMPRESA,
substring(dados,213,1) as ID_LOCAL_FUNC_PRISIONAL,
substring(dados,214,1) as ID_LOCAL_FUNC_TEMPLO_IGREJA,
substring(dados,215,1) as ID_LOCAL_FUNC_CASA_PROFESSOR,
substring(dados,216,1) as ID_LOCAL_FUNC_GALPAO,
substring(dados,217,1) as ID_LOCAL_FUNC_OUTROS,
substring(dados,218,1) as ID_LOCAL_FUNC_SALAS_OUTRA_ESC,
substring(dados,219,1) as ID_ESCOLA_COMP_PREDIO,
substring(dados,220,1) as ID_AGUA_FILTRADA,
substring(dados,221,1) as ID_AGUA_REDE_PUBLICA,
substring(dados,222,1) as ID_AGUA_POCO_ARTESIANO,
substring(dados,223,1) as ID_AGUA_CACIMBA,
substring(dados,224,1) as ID_AGUA_FONTE_RIO,
substring(dados,225,1) as ID_AGUA_INEXISTENTE,
substring(dados,226,1) as ID_ENERGIA_REDE_PUBLICA,
substring(dados,227,1) as ID_ENERGIA_GERADOR,
substring(dados,228,1) as ID_ENERGIA_OUTROS,
substring(dados,229,1) as ID_ENERGIA_INEXISTENTE,
substring(dados,230,1) as ID_ESGOTO_REDE_PUBLICA,
substring(dados,231,1) as ID_ESGOTO_FOSSA,
substring(dados,232,1) as ID_ESGOTO_INEXISTENTE,
substring(dados,233,1) as ID_LIXO_COLETA_PERIODICA,
substring(dados,234,1) as ID_LIXO_QUEIMA,
substring(dados,235,1) as ID_LIXO_JOGA_OUTRA_AREA,
substring(dados,236,1) as ID_LIXO_RECICLA,
substring(dados,237,1) as ID_LIXO_ENTERRA,
substring(dados,238,1) as ID_LIXO_OUTROS,
substring(dados,239,1) as ID_SALA_DIRETORIA,
substring(dados,240,1) as ID_SALA_PROFESSOR,
substring(dados,241,1) as ID_LABORATORIO_INFORMATICA,
substring(dados,242,1) as ID_LABORATORIO_CIENCIAS,
substring(dados,243,1) as ID_SALA_ATENDIMENTO_ESPECIAL,
substring(dados,244,1) as ID_QUADRA_ESPORTES_COBERTA,
substring(dados,245,1) as ID_QUADRA_ESPORTES_DESCOBERTA,
substring(dados,246,1) as ID_COZINHA,
substring(dados,247,1) as ID_BIBLIOTECA,
substring(dados,248,1) as ID_SALA_LEITURA,
substring(dados,249,1) as ID_PARQUE_INFANTIL,
substring(dados,250,1) as ID_BERCARIO,
substring(dados,251,1) as ID_SANITARIO_FORA_PREDIO,
substring(dados,252,1) as ID_SANITARIO_DENTRO_PREDIO,
substring(dados,253,1) as ID_SANITARIO_EI,
substring(dados,254,1) as ID_SANITARIO_PNE,
substring(dados,255,1) as ID_DEPENDENCIAS_PNE,
substring(dados,256,1) as ID_SECRETARIA,
substring(dados,257,1) as ID_BANHEIRO_CHUVEIRO,
substring(dados,258,1) as ID_REFEITORIO,
substring(dados,259,1) as ID_DESPENSA,
substring(dados,260,1) as ID_ALMOXARIFADO,
substring(dados,261,1) as ID_AUDITORIO,
substring(dados,262,1) as ID_PATIO_COBERTO,
substring(dados,263,1) as ID_PATIO_DESCOBERTO,
substring(dados,264,1) as ID_ALOJAM_ALUNO,
substring(dados,265,1) as ID_ALOJAM_PROFESSOR,
substring(dados,266,1) as ID_AREA_VERDE,
substring(dados,267,1) as ID_LAVANDERIA,
substring(dados,268,1) as ID_DEPENDENCIAS_OUTRAS,
substring(dados,269,5) as NUM_SALAS_EXISTENTES,
substring(dados,274,5) as NUM_SALAS_UTILIZADAS,
substring(dados,279,1) as ID_EQUIP_TV,
substring(dados,280,1) as ID_EQUIP_VIDEOCASSETE,
substring(dados,281,1) as ID_EQUIP_DVD,
substring(dados,282,1) as ID_EQUIP_PARABOLICA,
substring(dados,283,1) as ID_EQUIP_COPIADORA,
substring(dados,284,1) as ID_EQUIP_RETRO,
substring(dados,285,1) as ID_EQUIP_IMPRESSORA,
substring(dados,286,1) as ID_EQUIP_SOM,
substring(dados,287,1) as ID_EQUIP_MULTIMIDIA,
substring(dados,288,1) as ID_EQUIP_FAX,
substring(dados,289,1) as ID_EQUIP_FOTO,
substring(dados,290,1) as ID_COMPUTADORES,
substring(dados,291,5) as NUM_COMPUTADORES,
substring(dados,296,5) as NUM_COMP_ADMINISTRATIVOS,
substring(dados,301,5) as NUM_COMP_ALUNOS,
substring(dados,306,1) as ID_INTERNET,
substring(dados,307,2) as ID_BANDA_LARGA,
substring(dados,309,5) as NUM_FUNCIONARIOS,
substring(dados,314,1) as ID_ALIMENTACAO,
substring(dados,315,2) as ID_AEE,
substring(dados,317,2) as ID_MOD_ATIV_COMPLEMENTAR,
substring(dados,319,1) as ID_MOD_ENS_REGULAR,
substring(dados,320,1) as ID_REG_INFANTIL_CRECHE,
substring(dados,321,1) as ID_REG_INFANTIL_PREESCOLA,
substring(dados,322,1) as ID_REG_FUND_8_ANOS,
substring(dados,323,1) as ID_REG_FUND_9_ANOS,
substring(dados,324,1) as ID_REG_MEDIO_MEDIO,
substring(dados,325,1) as ID_REG_MEDIO_INTEGRADO,
substring(dados,326,1) as ID_REG_MEDIO_NORMAL,
substring(dados,327,1) as ID_REG_MEDIO_PROF,
substring(dados,328,1) as ID_MOD_ENS_ESP,
substring(dados,329,1) as ID_ESP_INFANTIL_CRECHE,
substring(dados,330,1) as ID_ESP_INFANTIL_PREESCOLA,
substring(dados,331,1) as ID_ESP_FUND_8_ANOS,
substring(dados,332,1) as ID_ESP_FUND_9_ANOS,
substring(dados,333,1) as ID_ESP_MEDIO_MEDIO,
substring(dados,334,1) as ID_ESP_MEDIO_INTEGRADO,
substring(dados,335,1) as ID_ESP_MEDIO_NORMAL,
substring(dados,336,1) as ID_ESP_MEDIO_PROFISSIONAL,
substring(dados,337,1) as ID_ESP_EJA_FUNDAMENTAL,
substring(dados,338,1) as ID_ESP_EJA_MEDIO,
substring(dados,339,1) as ID_MOD_EJA,
substring(dados,340,1) as ID_EJA_FUNDAMENTAL,
substring(dados,341,1) as ID_EJA_MEDIO,
substring(dados,342,1) as ID_EJA_PROJOVEM,
substring(dados,343,1) as ID_FUND_CICLOS,
substring(dados,344,1) as ID_LOCALIZACAO_DIFERENCIADA,
substring(dados,345,1) as ID_MATERIAL_ESP_NAO_UTILIZA,
substring(dados,346,1) as ID_MATERIAL_ESP_QUILOMBOLA,
substring(dados,347,1) as ID_MATERIAL_ESP_INDIGENA,
substring(dados,348,1) as ID_EDUCACAO_INDIGENA,
substring(dados,349,1) as ID_LINGUA_INDIGENA,
substring(dados,350,5) as FK_COD_LINGUA_INDIGENA,
substring(dados,355,1) as ID_LINGUA_PORTUGUESA,
substring(dados,356,1) as ID_ESPACO_TURMA_PBA,
substring(dados,357,1) as ID_ABRE_FINAL_SEMANA
from SC_2012_ESCOLA_BLOCO;

select * from SC_2012_ESCOLA;

drop table SC_2012_ESCOLA_BLOCO;