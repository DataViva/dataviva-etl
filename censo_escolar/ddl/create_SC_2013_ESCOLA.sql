use dataviva_raw;

create table SC_2013_ESCOLA_BLOCO( dados varchar(2000) not null);

load data local infile 'Y:/Censo Escolar/2013/DADOS/TS_ESCOLA.txt'
into table SC_2013_ESCOLA_BLOCO
character set 'latin1'
fields terminated by '\t'
lines terminated by '\n';

drop table if exists SC_2013_ESCOLA;
create table SC_2013_ESCOLA select 
substring(dados,1,5) as ANO_CENSO,
substring(dados,6,9) as PK_COD_ENTIDADE,
substring(dados,15,100) as NO_ENTIDADE,
substring(dados,115,10) as COD_ORGAO_REGIONAL_INEP,
substring(dados,125,15) as DESC_SITUACAO_FUNCIONAMENTO,
substring(dados,140,1) as DESC_SITUACAO_CENSO2013,
substring(dados,141,20) as DT_ANO_LETIVO_INICIO,
substring(dados,161,20) as DT_ANO_LETIVO_TERMINO,
substring(dados,181,3) as FK_COD_ESTADO,
substring(dados,184,2) as SIGLA,
substring(dados,186,9) as FK_COD_MUNICIPIO,
substring(dados,195,9) as FK_COD_DISTRITO,
substring(dados,204,1) as ID_DEPENDENCIA_ADM,
substring(dados,205,1) as ID_LOCALIZACAO,
substring(dados,206,1) as DESC_CATEGORIA_ESCOLA_PRIVADA,
substring(dados,207,1) as ID_CONVENIADA_PP,
substring(dados,208,2) as ID_TIPO_CONVENIO_PODER_PUBLICO,
substring(dados,210,1) as ID_MANT_ESCOLA_PRIVADA_EMP,
substring(dados,211,1) as ID_MANT_ESCOLA_PRIVADA_ONG,
substring(dados,212,1) as ID_MANT_ESCOLA_PRIVADA_SIND,
substring(dados,213,1) as ID_MANT_ESCOLA_PRIVADA_SIST_S,
substring(dados,214,1) as ID_MANT_ESCOLA_PRIVADA_S_FINS,
substring(dados,215,1) as ID_DOCUMENTO_REGULAMENTACAO,
substring(dados,216,1) as ID_LOCAL_FUNC_PREDIO_ESCOLAR,
substring(dados,217,1) as ID_LOCAL_FUNC_SALAS_EMPRESA,
substring(dados,218,1) as ID_LOCAL_FUNC_SOCIOEDUCATIVA,
substring(dados,219,1) as ID_LOCAL_FUNC_UNID_PRISIONAL,
substring(dados,220,1) as ID_LOCAL_FUNC_TEMPLO_IGREJA,
substring(dados,221,1) as ID_LOCAL_FUNC_CASA_PROFESSOR,
substring(dados,222,1) as ID_LOCAL_FUNC_GALPAO,
substring(dados,223,1) as ID_LOCAL_FUNC_OUTROS,
substring(dados,224,1) as ID_LOCAL_FUNC_SALAS_OUTRA_ESC,
substring(dados,225,1) as ID_ESCOLA_COMP_PREDIO,
substring(dados,226,1) as ID_AGUA_FILTRADA,
substring(dados,227,1) as ID_AGUA_REDE_PUBLICA,
substring(dados,228,1) as ID_AGUA_POCO_ARTESIANO,
substring(dados,229,1) as ID_AGUA_CACIMBA,
substring(dados,230,1) as ID_AGUA_FONTE_RIO,
substring(dados,231,1) as ID_AGUA_INEXISTENTE,
substring(dados,232,1) as ID_ENERGIA_REDE_PUBLICA,
substring(dados,233,1) as ID_ENERGIA_GERADOR,
substring(dados,234,1) as ID_ENERGIA_OUTROS,
substring(dados,235,1) as ID_ENERGIA_INEXISTENTE,
substring(dados,236,1) as ID_ESGOTO_REDE_PUBLICA,
substring(dados,237,1) as ID_ESGOTO_FOSSA,
substring(dados,238,1) as ID_ESGOTO_INEXISTENTE,
substring(dados,239,1) as ID_LIXO_COLETA_PERIODICA,
substring(dados,240,1) as ID_LIXO_QUEIMA,
substring(dados,241,1) as ID_LIXO_JOGA_OUTRA_AREA,
substring(dados,242,1) as ID_LIXO_RECICLA,
substring(dados,243,1) as ID_LIXO_ENTERRA,
substring(dados,244,1) as ID_LIXO_OUTROS,
substring(dados,245,1) as ID_SALA_DIRETORIA,
substring(dados,246,1) as ID_SALA_PROFESSOR,
substring(dados,247,1) as ID_LABORATORIO_INFORMATICA,
substring(dados,248,1) as ID_LABORATORIO_CIENCIAS,
substring(dados,249,1) as ID_SALA_ATENDIMENTO_ESPECIAL,
substring(dados,250,1) as ID_QUADRA_ESPORTES_COBERTA,
substring(dados,251,1) as ID_QUADRA_ESPORTES_DESCOBERTA,
substring(dados,252,1) as ID_COZINHA,
substring(dados,253,1) as ID_BIBLIOTECA,
substring(dados,254,1) as ID_SALA_LEITURA,
substring(dados,255,1) as ID_PARQUE_INFANTIL,
substring(dados,256,1) as ID_BERCARIO,
substring(dados,257,1) as ID_SANITARIO_FORA_PREDIO,
substring(dados,258,1) as ID_SANITARIO_DENTRO_PREDIO,
substring(dados,259,1) as ID_SANITARIO_EI,
substring(dados,260,1) as ID_SANITARIO_PNE,
substring(dados,261,1) as ID_DEPENDENCIAS_PNE,
substring(dados,262,1) as ID_SECRETARIA,
substring(dados,263,1) as ID_BANHEIRO_CHUVEIRO,
substring(dados,264,1) as ID_REFEITORIO,
substring(dados,265,1) as ID_DESPENSA,
substring(dados,266,1) as ID_ALMOXARIFADO,
substring(dados,267,1) as ID_AUDITORIO,
substring(dados,268,1) as ID_PATIO_COBERTO,
substring(dados,269,1) as ID_PATIO_DESCOBERTO,
substring(dados,270,1) as ID_ALOJAM_ALUNO,
substring(dados,271,1) as ID_ALOJAM_PROFESSOR,
substring(dados,272,1) as ID_AREA_VERDE,
substring(dados,273,1) as ID_LAVANDERIA,
substring(dados,274,1) as ID_DEPENDENCIAS_OUTRAS,
substring(dados,275,5) as NUM_SALAS_EXISTENTES,
substring(dados,280,5) as NUM_SALAS_UTILIZADAS,
substring(dados,285,5) as NUM_EQUIP_TV,
substring(dados,290,5) as NUM_EQUIP_VIDEOCASSETE,
substring(dados,295,5) as NUM_EQUIP_DVD,
substring(dados,300,5) as NUM_EQUIP_PARABOLICA,
substring(dados,305,5) as NUM_EQUIP_COPIADORA,
substring(dados,310,5) as NUM_EQUIP_RETRO,
substring(dados,315,5) as NUM_EQUIP_IMPRESSORA,
substring(dados,320,5) as NUM_EQUIP_SOM,
substring(dados,325,5) as NUM_EQUIP_MULTIMIDIA,
substring(dados,330,5) as NUM_EQUIP_FAX,
substring(dados,335,5) as NUM_EQUIP_FOTO,
substring(dados,340,5) as NUM_COMPUTADORES,
substring(dados,345,5) as NUM_COMP_ADMINISTRATIVOS,
substring(dados,350,5) as NUM_COMP_ALUNOS,
substring(dados,355,1) as ID_INTERNET,
substring(dados,356,2) as ID_BANDA_LARGA,
substring(dados,358,5) as NUM_FUNCIONARIOS,
substring(dados,363,1) as ID_ALIMENTACAO,
substring(dados,364,2) as ID_AEE,
substring(dados,366,2) as ID_MOD_ATIV_COMPLEMENTAR,
substring(dados,368,1) as ID_MOD_ENS_REGULAR,
substring(dados,369,1) as ID_REG_INFANTIL_CRECHE,
substring(dados,370,1) as ID_REG_INFANTIL_PREESCOLA,
substring(dados,371,1) as ID_REG_FUND_8_ANOS,
substring(dados,372,1) as ID_REG_FUND_9_ANOS,
substring(dados,373,1) as ID_REG_MEDIO_MEDIO,
substring(dados,374,1) as ID_REG_MEDIO_INTEGRADO,
substring(dados,375,1) as ID_REG_MEDIO_NORMAL,
substring(dados,376,1) as ID_REG_MEDIO_PROF,
substring(dados,377,1) as ID_MOD_ENS_ESP,
substring(dados,378,1) as ID_ESP_INFANTIL_CRECHE,
substring(dados,379,1) as ID_ESP_INFANTIL_PREESCOLA,
substring(dados,380,1) as ID_ESP_FUND_8_ANOS,
substring(dados,381,1) as ID_ESP_FUND_9_ANOS,
substring(dados,382,1) as ID_ESP_MEDIO_MEDIO,
substring(dados,383,1) as ID_ESP_MEDIO_INTEGRADO,
substring(dados,384,1) as ID_ESP_MEDIO_NORMAL,
substring(dados,385,1) as ID_ESP_MEDIO_PROFISSIONAL,
substring(dados,386,1) as ID_ESP_EJA_FUNDAMENTAL,
substring(dados,387,1) as ID_ESP_EJA_MEDIO,
substring(dados,388,1) as ID_MOD_EJA,
substring(dados,389,1) as ID_EJA_FUNDAMENTAL,
substring(dados,390,1) as ID_EJA_MEDIO,
substring(dados,391,1) as ID_EJA_PROJOVEM,
substring(dados,392,1) as ID_FUND_CICLOS,
substring(dados,393,1) as ID_LOCALIZACAO_DIFERENCIADA,
substring(dados,394,1) as ID_MATERIAL_ESP_NAO_UTILIZA,
substring(dados,395,1) as ID_MATERIAL_ESP_QUILOMBOLA,
substring(dados,396,1) as ID_MATERIAL_ESP_INDIGENA,
substring(dados,397,1) as ID_EDUCACAO_INDIGENA,
substring(dados,398,1) as ID_LINGUA_INDIGENA,
substring(dados,399,5) as FK_COD_LINGUA_INDIGENA,
substring(dados,404,1) as ID_LINGUA_PORTUGUESA,
substring(dados,405,1) as ID_ESPACO_TURMA_PBA,
substring(dados,406,1) as ID_ABRE_FINAL_SEMANA,
substring(dados,407,1) as ID_PROPOSTA_PEDAG_ALTERNANCIA
from SC_2013_ESCOLA_BLOCO;

select * from SC_2013_ESCOLA;

drop table SC_2013_ESCOLA_BLOCO;