use dataviva_raw;

create table SC_2008_ESCOLA_BLOCO( dados varchar(2000) not null);

load data local infile 'Y:/Censo Escolar/2008/DADOS/TS_ESCOLA.txt'
into table SC_2008_ESCOLA_BLOCO
character set 'latin1'
fields terminated by '\t'
lines terminated by '\n';

create table SC_2008_ESCOLA select 
substring(dados,1,7) as ANO_CENSO,
substring(dados,8,11) as PK_COD_ENTIDADE,
substring(dados,19,10) as COD_ORGAO_REGIONAL_INEP,
substring(dados,29,15) as DESC_SITUACAO_FUNCIONAMENTO,
substring(dados,44,20) as DT_ANO_LETIVO_INICIO,
substring(dados,64,20) as DT_ANO_LETIVO_TERMINO,
substring(dados,84,5) as FK_COD_ESTADO,
substring(dados,89,2) as SIGLA,
substring(dados,91,15) as FK_COD_MUNICIPIO,
substring(dados,106,1) as ID_DEPENDENCIA_ADM,
substring(dados,107,1) as ID_LOCALIZACAO,
substring(dados,108,1) as DESC_CATEGORIA_ESCOLA_PRIVADA,
substring(dados,109,1) as ID_CONVENIADA_PP,
substring(dados,110,8) as ID_TIPO_CONVENIO_PODER_PUBLICO,
substring(dados,118,1) as ID_MANT_ESCOLA_PRIVADA_EMP,
substring(dados,119,1) as ID_MANT_ESCOLA_PRIVADA_ONG,
substring(dados,120,1) as ID_MANT_ESCOLA_PRIVADA_SIND,
substring(dados,121,1) as ID_MANT_ESCOLA_PRIVADA_APAE,
substring(dados,122,1) as ID_DOCUMENTO_REGULAMENTACAO,
substring(dados,123,1) as ID_LOCAL_FUNC_PREDIO_ESCOLAR,
substring(dados,124,1) as ID_LOCAL_FUNC_SALAS_EMPRESA,
substring(dados,125,1) as ID_ESCOLA_COMP_PREDIO,
substring(dados,126,1) as ID_LOCAL_FUNC_PRISIONAL,
substring(dados,127,1) as ID_LOCAL_FUNC_TEMPLO_IGREJA,
substring(dados,128,1) as ID_LOCAL_FUNC_CASA_PROFESSOR,
substring(dados,129,1) as ID_LOCAL_FUNC_GALPAO,
substring(dados,130,1) as ID_LOCAL_FUNC_OUTROS,
substring(dados,131,1) as ID_LOCAL_FUNC_SALAS_OUTRA_ESC,
substring(dados,132,1) as ID_AGUA_FILTRADA,
substring(dados,133,1) as ID_AGUA_REDE_PUBLICA,
substring(dados,134,1) as ID_AGUA_POCO_ARTESIANO,
substring(dados,135,1) as ID_AGUA_CACIMBA,
substring(dados,136,1) as ID_AGUA_FONTE_RIO,
substring(dados,137,1) as ID_AGUA_INEXISTENTE,
substring(dados,138,1) as ID_ENERGIA_REDE_PUBLICA,
substring(dados,139,1) as ID_ENERGIA_GERADOR,
substring(dados,140,1) as ID_ENERGIA_OUTROS,
substring(dados,141,1) as ID_ENERGIA_INEXISTENTE,
substring(dados,142,1) as ID_ESGOTO_REDE_PUBLICA,
substring(dados,143,1) as ID_ESGOTO_FOSSA,
substring(dados,144,1) as ID_ESGOTO_INEXISTENTE,
substring(dados,145,1) as ID_LIXO_COLETA_PERIODICA,
substring(dados,146,1) as ID_LIXO_QUEIMA,
substring(dados,147,1) as ID_LIXO_JOGA_OUTRA_AREA,
substring(dados,148,1) as ID_LIXO_RECICLA,
substring(dados,149,1) as ID_LIXO_ENTERRA,
substring(dados,150,1) as ID_LIXO_OUTROS,
substring(dados,151,1) as ID_SALA_DIRETORIA,
substring(dados,152,1) as ID_SALA_PROFESSOR,
substring(dados,153,1) as ID_LABORATORIO_INFORMATICA,
substring(dados,154,1) as ID_LABORATORIO_CIENCIAS,
substring(dados,155,1) as ID_SALA_ATENDIMENTO_ESPECIAL,
substring(dados,156,1) as ID_QUADRA_ESPORTES,
substring(dados,157,1) as ID_COZINHA,
substring(dados,158,1) as ID_BIBLIOTECA,
substring(dados,159,1) as ID_PARQUE_INFANTIL,
substring(dados,160,1) as ID_SANITARIO_FORA_PREDIO,
substring(dados,161,1) as ID_SANITARIO_DENTRO_PREDIO,
substring(dados,162,1) as ID_SANITARIO_PNE,
substring(dados,163,1) as ID_DEPENDENCIAS_PNE,
substring(dados,164,1) as ID_DEPENDENCIAS_OUTRAS,
substring(dados,165,7) as NUM_SALAS_EXISTENTES,
substring(dados,172,7) as NUM_SALAS_UTILIZADAS,
substring(dados,179,1) as ID_EQUIP_TV,
substring(dados,180,1) as ID_EQUIP_VIDEOCASSETE,
substring(dados,181,1) as ID_EQUIP_DVD,
substring(dados,182,1) as ID_EQUIP_PARABOLICA,
substring(dados,183,1) as ID_EQUIP_COPIADORA,
substring(dados,184,1) as ID_EQUIP_RETRO,
substring(dados,185,1) as ID_EQUIP_IMPRESSORA,
substring(dados,186,1) as ID_EQUIP_IMPRESSORA_BRAILE,
substring(dados,187,1) as ID_COMPUTADORES,
substring(dados,188,7) as NUM_COMPUTADORES,
substring(dados,195,7) as NUM_COMP_ADMINISTRATIVOS,
substring(dados,202,7) as NUM_COMP_ALUNOS,
substring(dados,209,1) as ID_INTERNET,
substring(dados,210,1) as ID_BANDA_LARGA,
substring(dados,211,7) as NUM_FUNCIONARIOS,
substring(dados,218,7) as NUM_LIVROS_DEV_2SERIE,
substring(dados,225,7) as NUM_LIVROS_DEV_3SERIE,
substring(dados,232,7) as NUM_LIVROS_DEV_4SERIE,
substring(dados,239,7) as NUM_LIVROS_DEV_5SERIE,
substring(dados,246,7) as NUM_LIVROS_DEV_6SERIE,
substring(dados,253,7) as NUM_LIVROS_DEV_7SERIE,
substring(dados,260,7) as NUM_LIVROS_DEV_8SERIE,
substring(dados,267,7) as NUM_LIVROS_REU_2SERIE,
substring(dados,274,7) as NUM_LIVROS_REU_3SERIE,
substring(dados,281,7) as NUM_LIVROS_REU_4SERIE,
substring(dados,288,7) as NUM_LIVROS_REU_5SERIE,
substring(dados,295,7) as NUM_LIVROS_REU_6SERIE,
substring(dados,302,7) as NUM_LIVROS_REU_7SERIE,
substring(dados,309,7) as NUM_LIVROS_REU_8SERIE,
substring(dados,316,1) as ID_ALIMENTACAO,
substring(dados,317,1) as ID_MOD_ATIV_COMPLEMENTAR,
substring(dados,318,1) as ID_MOD_ENS_REGULAR,
substring(dados,319,1) as ID_REG_INFANTIL_CRECHE,
substring(dados,320,1) as ID_REG_INFANTIL_PREESCOLA,
substring(dados,321,1) as ID_REG_FUND_8_ANOS,
substring(dados,322,1) as ID_REG_FUND_9_ANOS,
substring(dados,323,1) as ID_REG_MEDIO_MEDIO,
substring(dados,324,1) as ID_REG_MEDIO_INTEGRADO,
substring(dados,325,1) as ID_REG_MEDIO_NORMAL,
substring(dados,326,1) as ID_REG_MEDIO_PROF,
substring(dados,327,1) as ID_MOD_ENS_ESP,
substring(dados,328,1) as ID_ESP_INFANTIL_CRECHE,
substring(dados,329,1) as ID_ESP_INFANTIL_PREESCOLA,
substring(dados,330,1) as ID_ESP_FUND_8_ANOS,
substring(dados,331,1) as ID_ESP_FUND_9_ANOS,
substring(dados,332,1) as ID_ESP_MEDIO_MEDIO,
substring(dados,333,1) as ID_ESP_MEDIO_INTEGRADO,
substring(dados,334,1) as ID_ESP_MEDIO_NORMAL,
substring(dados,335,1) as ID_ESP_MEDIO_PROFISSIONAL,
substring(dados,336,1) as ID_ESP_EJA_FUNDAMENTAL,
substring(dados,337,1) as ID_ESP_EJA_MEDIO,
substring(dados,338,1) as ID_MOD_EJA,
substring(dados,339,1) as ID_EJA_FUNDAMENTAL,
substring(dados,340,1) as ID_EJA_MEDIO,
substring(dados,341,1) as ID_LOCALIZACAO_DIFERENCIADA,
substring(dados,342,1) as ID_MATERIAL_ESP_NAO_UTILIZA,
substring(dados,343,1) as ID_MATERIAL_ESP_QUILOMBOLAS,
substring(dados,344,1) as ID_MATERIAL_ESP_INDIGENA,
substring(dados,345,1) as ID_MATERIAL_ESP_CEGOS,
substring(dados,346,1) as ID_MATERIAL_ESP_SURDOS,
substring(dados,347,1) as ID_EDUCACAO_INDIGENA,
substring(dados,348,1) as ID_LINGUA_INDIGENA,
substring(dados,349,8) as FK_COD_LINGUA_INDIGENA,
substring(dados,357,1) as ID_LINGUA_PORTUGUESA,
substring(dados,358,7) as NUM_ALUNOS_ED_COMP_ESCOLA,
substring(dados,365,7) as NUM_ALUNOS_ED_COMP_OUTRA
from SC_2008_ESCOLA_BLOCO;

select * from SC_2008_ESCOLA;

drop table SC_2008_ESCOLA_BLOCO;